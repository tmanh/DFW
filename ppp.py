import matplotlib.pyplot as plt
import networkx as nx

# Original edges
edges = [
    ((50.877827, 3.690515), (50.87784309922046, 3.6905048400168705), 1),
    ((50.87784309922046, 3.6905048400168705), (50.87329717351446, 3.692777772476414), 1),
    ((50.88498298943323, 3.693711150797316), (50.88497392397139, 3.6937435474614166), 1),
    ((50.88497392397139, 3.6937435474614166), (50.88528937734923, 3.6872850691320114), 1),
    ((50.88528937734923, 3.6872850691320114), (50.87329717351446, 3.692777772476414), 1),
    ((50.88541834624587, 3.686130099317326), (50.88539147072903, 3.6861083783904833), 1),
    ((50.88539147072903, 3.6861083783904833), (50.88528937734923, 3.6872850691320114), 1),
    ((50.88332, 3.708224), (50.88340616585186, 3.7082183264539927), 1),
    ((50.88340616585186, 3.7082183264539927), (50.88528937734923, 3.6872850691320114), 1),
    ((50.88303533138356, 3.716709589855025), (50.88305495130109, 3.7167397112794633), 1),
    ((50.88305495130109, 3.7167397112794633), (50.88528937734923, 3.6872850691320114), 1),
    ((50.84865217525669, 3.71206251112564), (50.87329717351446, 3.692777772476414), 1),
    ((50.880013, 3.734605), (50.880248698996525, 3.7346089761780568), 1),
    ((50.880248698996525, 3.7346089761780568), (50.88528937734923, 3.6872850691320114), 1),
    ((50.9148702570547, 3.6705370384779), (50.915025540210834, 3.670916053595759), 1),
    ((50.915025540210834, 3.670916053595759), (50.88528937734923, 3.6872850691320114), 1),
    ((50.87907571883665, 3.742391593839773), (50.87905348466323, 3.7424694041417084), 1),
    ((50.87905348466323, 3.7424694041417084), (50.88528937734923, 3.6872850691320114), 1),
    ((50.81312026, 3.679699711), (50.87329717351446, 3.692777772476414), -1),
    ((50.9296307282077, 3.6542880951664), (50.92940948118609, 3.6540433756779502), 1),
    ((50.92940948118609, 3.6540433756779502), (50.88528937734923, 3.6872850691320114), 1),
    ((50.86176331477927, 3.765947100079222), (50.86176372226056, 3.7659473554521643), 1),
    ((50.86176372226056, 3.7659473554521643), (50.88528937734923, 3.6872850691320114), 1),
    ((50.844951, 3.763472), (50.84497792846998, 3.7634825505635745), 1),
    ((50.84497792846998, 3.7634825505635745), (50.860689082165486, 3.7665179183595274), 1),
    ((50.860689082165486, 3.7665179183595274), (50.88528937734923, 3.6872850691320114), 1),
    ((50.8634364057813, 3.771243959792352), (50.860689082165486, 3.7665179183595274), 1),
    ((50.860689082165486, 3.7665179183595274), (50.88528937734923, 3.6872850691320114), 1),
    ((50.898797, 3.617027), (50.87329717351446, 3.692777772476414), -1),
    ((50.83376576214968, 3.76898864658583), (50.88528937734923, 3.6872850691320114), 1),
    ((50.94754787056984, 3.638493838397924), (50.87329717351446, 3.692777772476414), 1),
    ((50.80790167884659, 3.626698144970669), (50.87329717351446, 3.692777772476414), -1),
    ((50.8260145913424, 3.61160845853722), (50.87329717351446, 3.692777772476414), -1),
    ((50.89711467, 3.601662218), (50.87329717351446, 3.692777772476414), -1)
]

# Nodes to keep
nodes_to_keep = {
    (50.877827, 3.690515),
    (50.88498298943323, 3.693711150797316),
    (50.88541834624587, 3.686130099317326),
    (50.88332, 3.708224),
    (50.88303533138356, 3.716709589855025),
    (50.84865217525669, 3.71206251112564),
    (50.880013, 3.734605),
    (50.9148702570547, 3.6705370384779),
    (50.87907571883665, 3.742391593839773),
    (50.87329717351446, 3.692777772476414),
}

# Build graph
G = nx.Graph()
for src, dst, _ in edges:
    if src in nodes_to_keep or dst in nodes_to_keep:
        G.add_edge(src, dst)

# Trim graph to only connected paths containing nodes_to_keep
sub_nodes = set()
for node in nodes_to_keep:
    if node in G:
        for n in nx.node_connected_component(G, node):
            sub_nodes.add(n)
G_trimmed = G.subgraph(sub_nodes)

# Plot trimmed graph
plt.figure(figsize=(8, 8))
pos = {node: (node[1], node[0]) for node in G_trimmed.nodes()}  # lon, lat
nx.draw(G_trimmed, pos, with_labels=False, node_size=50, node_color="lightblue", edge_color="gray")
plt.xlabel("Longitude")
plt.ylabel("Latitude")
plt.title("Trimmed Graph with Paths Containing Specified Nodes")
plt.savefig("trimmed_graph.png")
